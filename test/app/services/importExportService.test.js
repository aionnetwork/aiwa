/* eslint-disable no-unused-vars */
import * as importExportService from '../../../app/services/importExportService';

const assert = require('assert');

const fileName = 'UTC-1543578932058_vault';
const longFileName = 'UTC-15433464566767756457777549754359743598743598745984375495745978459475767766565756576765787575734356578932058_vault';
const content = '{"content":{"$super":{"$super":{}},"ciphertext":{"words":[-2081363903,757938780,89310312,482996900,2056427353,-35070636,1220182109,1258093755,1232568206,-561908269,-1872610983,1669175553,242617010,-117996897,-766923513,1826743033,-1054345295,-355682325,-263331095,-873655632,1049422197,-1958633856,-1318648608,584275203,-896147180,2089360677,-237014384,471853566,1250170335,418859042,-1569619008,-694107837,-89017142,2011648184,-296320690,382476192,688917236,1495869158,-1197453545,1319726681,1205943071,588835820,1765788028,-1946538778,1721371335,-978982097,190915624,1751010006,690284940,1920934882,9082579,-465955176,-886522209,-571787872,-2104194577,-725343739,-1254111721,-1683127156,-174881345,1453962231,-716226967,2125268313,31595680,-2012831283,-812911677,1135013074,151734809,489631617,-2014038719,-797590086,1161586902,-961406142,1173884596,-1780064551,1762891802,189731457,-545288158,1300247720,2011870076,926677048,761936120,-1148878455,609518248,-1312203877,-293454366,-214208421,-1187886,324730817,1557158613,204676839,2050930096,2000864059,149551863,-2061514207,1417657964,527207739,-1509322036,601562105,-1267937001,-1680173602,-835803652,-850421816,1468900761,1388254365,-1317671450,-476408582,-1327801744,625438983,-305125934,1469896778,694630875,1192225353,-1263114761,-1942547958,1867382653,-1796640377,1313135197,-366321167,750399714,1311259118,-1798449213,770368980,-644214223,931782758,958109372,13919959,8324146,731433708,839102843,1829055384,-1902718920,473385845,-2090038858,-1287280701,767347603,-563907338,-1930822435,-1247366554,-2109648214,-1096987729,1065343368,940276466,839948137,1319623430,951601007,512890981,889946603,1115874469,-1706742075,21546870,-1662398990,1309765798,-970202068,-1288402165,407335961,-964687424,-1697116842,80718254,-594906636,-9466108,677818041,-633323140,1720054130,1722061598,900997822,-638038517,117322161,-98208551,-636534451,1544623242,-444117270,-1172027121,-135417973,385464038,-962478424,-942097588,500084320,-1913672175,-69810783,-1506145002,-331012920,-1170811332,366221799,-482719511,2041337775,-1317763345,2082584794,1122830636,1133296089,437920275,-1754796608,1830362373,-1377302906,1391675762,1383228741,-531558926,-2115119425,-1043831378,1669544138,-468652716,691446541,-1494025740,314728511,917253374,-1814604992,-114165315,-997347050,-1312942000,1297963251,-1583652559,200058008,-2110810560,-1226520519,-313018097,-628317489,1127392165,1911378475,627102741,126407067,-771110672,-417947566,-225376636,686739316,-2033583383,50224311,-2077975384,722226410,-1189035483,-530678219,1479370281,-1495433570,185085005,627161900,1518805411,1386529440,926498155,636162109,-546798297,-573637218,-49050087,-29945841,673137948,-40480756,-1631370672,-1058442988,1246799710,708118194,-246798741,471316981,734707485,1971856509,-5007234,1385948496,-527132367,-1586048269,597338507,-1389077958,1404932379,-1280826225,1022417513,197625633,-96902355,221123267,-631550790,1023115059,1050454804,-2040845051,1284167588,-55524643,485902793,-61890208,1369938687,-1447390494,-1844666771,-594559808,874167987,-1999262346,-460495265,713333918,-879313899,-1985585774,-2100974380,-1804229014,-1665364191,1782716736,-1948667435,-467935562,794105625,-1710808080,1879793242,1131190975,1132820118,-499501401,-889275506,-1602521542,185089001,-672914982,-907925540,584420727,1665519042,904209176,471519825,-885237750,-793532516,825948228,-1841188688,2084386180,-10408176,868393803,1376362123,2041039162,-792755928,-555910744,1239751051,1616787086,-61395307,1561098765,539449531,-1139927759,-215596562,-1728696295,323116395,862152899,-1591045252,-1330787781,1787288000,-1596098447,-803658717,-1977765108,-1665418110,995760374,1673735372,-783818702,984751684,28491001,-494718419,-1745552603,-1264930698,754428210,-1572847356,-1367105423,-711812380,-1180105429,-1548140847,-890452786,1653343732,-554385799,314447887,863724610,399562837,-637648261,953390762,-1120144079,-783109470,2046104714,-2048556634,196035378,1627283829,-1055660835,-2062404690,1799270533,-557089453,-2070318669,1984655482,-264118019,-119346546,-63839998,-1933621328,-1345028372,-1677177214,-182438093,1251496065,1075926616,-683683175,-574028872,1024049044,-501127187,-880914980,1349888020,1350975210,-694876891,1471616611,-570955645,965090682,1790911593,339997361,507034544,112102768,-2136606494,-1149627790,-2045137750,536338372,21441398,1697849055,466641319,-657881799,-1607532473,1160120537,814860213,841314407,-464669190,-872396376,729776894,11287416,-1083247839,751717931,-178203125,-405484505,-1754519276,857881273,-351994981,1445509322,-972844960,-555494915,-1099334860,1212475054,1041889871,1671999360,509838921,-1274984335,1168187686,-1690082724,-318500420,-1707651705,342045003,-1449049522,-2070347328,-1576857336,816563597,-1880458697,2064407538,-1238480725,-1154346802,-1683068424,-1988024579,-11293579,-1463504117,365577436,651081508,-1904396486,475065078,566761501,-1002358257,1370381991,1086198894,-1051311695,-669478861,-792991939,-284727204,961205658,-1150839125,-1341585865,2120314156,-1667580027,-1673718030,-1083686513,-1176406780,1902976469,-1129121630,-194544465,-1397146295,2031116576,-1777137705,-1513768212,474267364,1778871586,927119124,1150283294,-371460114,-139003691,1274930332,376611413,-1040048497,-77521147,-2005292191,-2020036053,-58442668,1199604469,-683544665,-2062182034,2007371539,511970050,-1649303378,-1278912396,-847757304,-1559385954,-1879093865,-1988331838,1210240735,-1811904176,-1897579097,1936588426,1861823382,-1330530245,-57263113,1748129276,2088509819,375987774,352578308,-1210857722,-1173689791,-572651207,364360762,-281308129,-763838701,1487177559,-92260101,71657084,-1787118984,1040165154,-2049068657,1639735788,2129232732,1480604114,-838151549,-1428741343,-1895573241,1613719793,2066550742,1657549361,1165478475,819919221,-1501576793,-1930879987,313487185,-1236635038,-284668440,12856701,-1234858430,265641912,-91728874,882237290,-400741892,1612061746,-36497416,169215861,1852806576,1055207380,1901052031,1083280801,1030064987,-947206891,-1884100328,-7836146,-448673488,1230596986,1507856110,-186394520,2006277334,1677213200,1465791963,2147462841,-1485284665,510784578,491970171,-351146709,-1642241013,1824827389,76776322,-1778496570,428785466,1659591950,-43892418,206377856,618153558,-178719055,450962467,1659290881,-1639789382,-748392772,-430951900,-967157234,-55585826,1808706364,1999662640,-1792604708,2106654221,2048855792,978145117,674062048,267098025,1868054118,-529375406,1444295275,536511665,-1500879121,1838915108,1182268883,10576157,-1578502887,-1385374805,-1670583874,-1884476192,-1028131484,-1173035526,510874634,538966200,1186403043,-576295904,2018398094,-1875588648,1749711401,-1401656594,1173412698,1945404196,-1769173152,-1648072246,-1606585645,1450437979,-10402978,715655480,-1308681615,-534342187,-431367543,-1668981669,1282141148,855331650,1302098159,-1251213651,-915055998,697750902,350829487,-1093922047,-613930762,704158373,-1094860544,136334389,533026304,544599295,-1137126952,1998836595,-1798446557,458648529,313946534,1332831003,1452548630,924277083,-1445799956,-2092734506,300409475,-684186872,-1229076997,-338172518,13410344,1221031183,-2097224998,-1581966383,660575437,1675754527,-1493497662,293244421,-668199257,-1492360886,-162158188,1561808399,945454405,-1094997788,1504390102,-345096238,-1350580710],"sigBytes":2640},"key":{"$super":{"$super":{"$ref":"$["content"]["$super"]["$super"]"}},"words":[-294512968,1181110219,1468741314,956025913,-588925746,-730440263,1909745187,734133384,78017672,-2042207120,1128153785,-1310311115],"sigBytes":32},"iv":{"$super":{"$ref":"$["content"]["key"]["$super"]"},"words":[78017672,-2042207120,1128153785,-1310311115],"sigBytes":16},"algorithm":{"keySize":8,"$super":{"cfg":{"mode":{"$super":{"$super":{"$ref":"$["content"]["$super"]["$super"]"}},"Encryptor":{"$super":{"$ref":"$["content"]["algorithm"]["$super"]["cfg"]["mode"]"}},"Decryptor":{"$super":{"$ref":"$["content"]["algorithm"]["$super"]["cfg"]["mode"]"}}},"padding":{},"$super":{"$super":{"$ref":"$["content"]["$super"]["$super"]"}}},"blockSize":4,"$super":{"cfg":{"$ref":"$["content"]["algorithm"]["$super"]["cfg"]["$super"]"},"keySize":4,"ivSize":4,"_ENC_XFORM_MODE":1,"_DEC_XFORM_MODE":2,"$super":{"_minBufferSize":0,"$super":{"$ref":"$["content"]["$super"]["$super"]"}}}}},"mode":{"$ref":"$["content"]["algorithm"]["$super"]["cfg"]["mode"]"},"padding":{"$ref":"$["content"]["algorithm"]["$super"]["cfg"]["padding"]"},"blockSize":4,"formatter":{},"salt":{"words":[1596503540,-971884872],"sigBytes":8}},"version":0.02,"timestamp":1543578932052}';
const mockLongFileName = 'UTC-1543346456676775645777754975435974359874359874...34356578932058_vault';
const fileResult = '{"content":{"$super":{"$super":{}},"ciphertext":{"words":[-2081363903,757938780,89310312,482996900,2056427353,-35070636,1220182109,1258093755,1232568206,-561908269,-1872610983,1669175553,242617010,-117996897,-766923513,1826743033,-1054345295,-355682325,-263331095,-873655632,1049422197,-1958633856,-1318648608,584275203,-896147180,2089360677,-237014384,471853566,1250170335,418859042,-1569619008,-694107837,-89017142,2011648184,-296320690,382476192,688917236,1495869158,-1197453545,1319726681,1205943071,588835820,1765788028,-1946538778,1721371335,-978982097,190915624,1751010006,690284940,1920934882,9082579,-465955176,-886522209,-571787872,-2104194577,-725343739,-1254111721,-1683127156,-174881345,1453962231,-716226967,2125268313,31595680,-2012831283,-812911677,1135013074,151734809,489631617,-2014038719,-797590086,1161586902,-961406142,1173884596,-1780064551,1762891802,189731457,-545288158,1300247720,2011870076,926677048,761936120,-1148878455,609518248,-1312203877,-293454366,-214208421,-1187886,324730817,1557158613,204676839,2050930096,2000864059,149551863,-2061514207,1417657964,527207739,-1509322036,601562105,-1267937001,-1680173602,-835803652,-850421816,1468900761,1388254365,-1317671450,-476408582,-1327801744,625438983,-305125934,1469896778,694630875,1192225353,-1263114761,-1942547958,1867382653,-1796640377,1313135197,-366321167,750399714,1311259118,-1798449213,770368980,-644214223,931782758,958109372,13919959,8324146,731433708,839102843,1829055384,-1902718920,473385845,-2090038858,-1287280701,767347603,-563907338,-1930822435,-1247366554,-2109648214,-1096987729,1065343368,940276466,839948137,1319623430,951601007,512890981,889946603,1115874469,-1706742075,21546870,-1662398990,1309765798,-970202068,-1288402165,407335961,-964687424,-1697116842,80718254,-594906636,-9466108,677818041,-633323140,1720054130,1722061598,900997822,-638038517,117322161,-98208551,-636534451,1544623242,-444117270,-1172027121,-135417973,385464038,-962478424,-942097588,500084320,-1913672175,-69810783,-1506145002,-331012920,-1170811332,366221799,-482719511,2041337775,-1317763345,2082584794,1122830636,1133296089,437920275,-1754796608,1830362373,-1377302906,1391675762,1383228741,-531558926,-2115119425,-1043831378,1669544138,-468652716,691446541,-1494025740,314728511,917253374,-1814604992,-114165315,-997347050,-1312942000,1297963251,-1583652559,200058008,-2110810560,-1226520519,-313018097,-628317489,1127392165,1911378475,627102741,126407067,-771110672,-417947566,-225376636,686739316,-2033583383,50224311,-2077975384,722226410,-1189035483,-530678219,1479370281,-1495433570,185085005,627161900,1518805411,1386529440,926498155,636162109,-546798297,-573637218,-49050087,-29945841,673137948,-40480756,-1631370672,-1058442988,1246799710,708118194,-246798741,471316981,734707485,1971856509,-5007234,1385948496,-527132367,-1586048269,597338507,-1389077958,1404932379,-1280826225,1022417513,197625633,-96902355,221123267,-631550790,1023115059,1050454804,-2040845051,1284167588,-55524643,485902793,-61890208,1369938687,-1447390494,-1844666771,-594559808,874167987,-1999262346,-460495265,713333918,-879313899,-1985585774,-2100974380,-1804229014,-1665364191,1782716736,-1948667435,-467935562,794105625,-1710808080,1879793242,1131190975,1132820118,-499501401,-889275506,-1602521542,185089001,-672914982,-907925540,584420727,1665519042,904209176,471519825,-885237750,-793532516,825948228,-1841188688,2084386180,-10408176,868393803,1376362123,2041039162,-792755928,-555910744,1239751051,1616787086,-61395307,1561098765,539449531,-1139927759,-215596562,-1728696295,323116395,862152899,-1591045252,-1330787781,1787288000,-1596098447,-803658717,-1977765108,-1665418110,995760374,1673735372,-783818702,984751684,28491001,-494718419,-1745552603,-1264930698,754428210,-1572847356,-1367105423,-711812380,-1180105429,-1548140847,-890452786,1653343732,-554385799,314447887,863724610,399562837,-637648261,953390762,-1120144079,-783109470,2046104714,-2048556634,196035378,1627283829,-1055660835,-2062404690,1799270533,-557089453,-2070318669,1984655482,-264118019,-119346546,-63839998,-1933621328,-1345028372,-1677177214,-182438093,1251496065,1075926616,-683683175,-574028872,1024049044,-501127187,-880914980,1349888020,1350975210,-694876891,1471616611,-570955645,965090682,1790911593,339997361,507034544,112102768,-2136606494,-1149627790,-2045137750,536338372,21441398,1697849055,466641319,-657881799,-1607532473,1160120537,814860213,841314407,-464669190,-872396376,729776894,11287416,-1083247839,751717931,-178203125,-405484505,-1754519276,857881273,-351994981,1445509322,-972844960,-555494915,-1099334860,1212475054,1041889871,1671999360,509838921,-1274984335,1168187686,-1690082724,-318500420,-1707651705,342045003,-1449049522,-2070347328,-1576857336,816563597,-1880458697,2064407538,-1238480725,-1154346802,-1683068424,-1988024579,-11293579,-1463504117,365577436,651081508,-1904396486,475065078,566761501,-1002358257,1370381991,1086198894,-1051311695,-669478861,-792991939,-284727204,961205658,-1150839125,-1341585865,2120314156,-1667580027,-1673718030,-1083686513,-1176406780,1902976469,-1129121630,-194544465,-1397146295,2031116576,-1777137705,-1513768212,474267364,1778871586,927119124,1150283294,-371460114,-139003691,1274930332,376611413,-1040048497,-77521147,-2005292191,-2020036053,-58442668,1199604469,-683544665,-2062182034,2007371539,511970050,-1649303378,-1278912396,-847757304,-1559385954,-1879093865,-1988331838,1210240735,-1811904176,-1897579097,1936588426,1861823382,-1330530245,-57263113,1748129276,2088509819,375987774,352578308,-1210857722,-1173689791,-572651207,364360762,-281308129,-763838701,1487177559,-92260101,71657084,-1787118984,1040165154,-2049068657,1639735788,2129232732,1480604114,-838151549,-1428741343,-1895573241,1613719793,2066550742,1657549361,1165478475,819919221,-1501576793,-1930879987,313487185,-1236635038,-284668440,12856701,-1234858430,265641912,-91728874,882237290,-400741892,1612061746,-36497416,169215861,1852806576,1055207380,1901052031,1083280801,1030064987,-947206891,-1884100328,-7836146,-448673488,1230596986,1507856110,-186394520,2006277334,1677213200,1465791963,2147462841,-1485284665,510784578,491970171,-351146709,-1642241013,1824827389,76776322,-1778496570,428785466,1659591950,-43892418,206377856,618153558,-178719055,450962467,1659290881,-1639789382,-748392772,-430951900,-967157234,-55585826,1808706364,1999662640,-1792604708,2106654221,2048855792,978145117,674062048,267098025,1868054118,-529375406,1444295275,536511665,-1500879121,1838915108,1182268883,10576157,-1578502887,-1385374805,-1670583874,-1884476192,-1028131484,-1173035526,510874634,538966200,1186403043,-576295904,2018398094,-1875588648,1749711401,-1401656594,1173412698,1945404196,-1769173152,-1648072246,-1606585645,1450437979,-10402978,715655480,-1308681615,-534342187,-431367543,-1668981669,1282141148,855331650,1302098159,-1251213651,-915055998,697750902,350829487,-1093922047,-613930762,704158373,-1094860544,136334389,533026304,544599295,-1137126952,1998836595,-1798446557,458648529,313946534,1332831003,1452548630,924277083,-1445799956,-2092734506,300409475,-684186872,-1229076997,-338172518,13410344,1221031183,-2097224998,-1581966383,660575437,1675754527,-1493497662,293244421,-668199257,-1492360886,-162158188,1561808399,945454405,-1094997788,1504390102,-345096238,-1350580710],"sigBytes":2640},"key":{"$super":{"$super":{"$ref":"$["content"]["$super"]["$super"]"}},"words":[-294512968,1181110219,1468741314,956025913,-588925746,-730440263,1909745187,734133384,78017672,-2042207120,1128153785,-1310311115],"sigBytes":32},"iv":{"$super":{"$ref":"$["content"]["key"]["$super"]"},"words":[78017672,-2042207120,1128153785,-1310311115],"sigBytes":16},"algorithm":{"keySize":8,"$super":{"cfg":{"mode":{"$super":{"$super":{"$ref":"$["content"]["$super"]["$super"]"}},"Encryptor":{"$super":{"$ref":"$["content"]["algorithm"]["$super"]["cfg"]["mode"]"}},"Decryptor":{"$super":{"$ref":"$["content"]["algorithm"]["$super"]["cfg"]["mode"]"}}},"padding":{},"$super":{"$super":{"$ref":"$["content"]["$super"]["$super"]"}}},"blockSize":4,"$super":{"cfg":{"$ref":"$["content"]["algorithm"]["$super"]["cfg"]["$super"]"},"keySize":4,"ivSize":4,"_ENC_XFORM_MODE":1,"_DEC_XFORM_MODE":2,"$super":{"_minBufferSize":0,"$super":{"$ref":"$["content"]["$super"]["$super"]"}}}}},"mode":{"$ref":"$["content"]["algorithm"]["$super"]["cfg"]["mode"]"},"padding":{"$ref":"$["content"]["algorithm"]["$super"]["cfg"]["padding"]"},"blockSize":4,"formatter":{},"salt":{"words":[1596503540,-971884872],"sigBytes":8}},"version":0.02,"timestamp":1543578932052}';

describe('expCreateExportElement', () => {
  it('should return element', () => {
    global.document = {
      // eslint-disable-next-line no-unused-vars
      createElement: arg => ({}),
    };
    // eslint-disable-next-line func-names
    const BlobObj = function (arg1, arg2) {
      return {};
    }; // this is file object
    global.Blob = BlobObj;
    global.URL = {
      createObjectURL: arg => ({}),
    };

    const output = importExportService.expCreateExportElement(document, content, fileName);
    assert.equal(output.download, fileName, 'output should be as expected');
    //console.log('The output is : ', output);
  });
});

describe('trimFileName', () => {
  it('it should return filename whatever we are passing', () => {
    const output = importExportService.trimFileName(fileName);
    assert.equal(output, fileName, 'output should be as expected');
  });
  it('it should passing more than 80 characters in filename and returning max. 80 characters', () => {
    const output = importExportService.trimFileName(longFileName);
    assert.equal(output, mockLongFileName, 'Output should be as expected');
  });
});

describe('readFile', () => {
  //not getting blob object and file object in stub
  it('read the content of given file', async () => {
    // eslint-disable-next-line func-names
    //const BlobObj = function (arg1, arg2) { return {}; }; // this is file object
    //global.Blob = BlobObj;
    //const FileReaderObj = function () { return {}; };
    //FileReaderObj.prototype.readAsText = (arg) => ({});
    //global.FileReader = FileReaderObj;
    const temp = new window.Blob([content]);
    const output = await importExportService.readFile(temp, true);
    assert.equal(output.result, fileResult, 'Output should be as expected');
  });
  it('read the content of given file as binary', async () => {
    global.document = {
      // eslint-disable-next-line no-unused-vars
      createElement: arg => ({}),
    };
    // eslint-disable-next-line func-names
    //const BlobObj = function (arg1, arg2) { return {}; }; // this is file object
    //global.Blob = BlobObj;
    const temp = new window.Blob([content]);
    const output = await importExportService.readFile(temp, false);
    assert.equal(JSON.stringify(output.result).toString(), '{}', 'Output should be as expected');
  });
});
